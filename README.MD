# Telegram CLI (Telethon) — README

Коротко: простой терминальный Telegram‑клиент на Python, использующий Telethon (MTProto). Поддерживает macOS, командный интерфейс (prompt), русский и английский языки, отправку/приём медиа.

Требования
- Python 3.10+
- Библиотеки (установите через pip):
  - telethon
  - python-dotenv
  - aiofiles

Установка
1. Клонируйте или создайте папку проекта и поместите файлы из первого варианта:
   - client.py
   - util.py
   - .env (файл конфигурации)

2. Создайте и активируйте виртуальное окружение:
   python3 -m venv venv
   source venv/bin/activate

3. Установите зависимости:
   pip install telethon python-dotenv aiofiles

Конфигурация (.env)
Создайте в корне проекта файл .env с содержимым:
API_ID=ВАШ_API_ID
API_HASH=ВАШ_API_HASH
SESSION_NAME=session

Откуда взять API_ID и API_HASH
1. Перейдите на https://my.telegram.org и войдите под своим номером телефона (Telegram пришлёт код в приложение).
2. Откройте "API development tools" (или "Создать приложение"/"Create new application").
3. Заполните поля (App title, Short name и т. п.) и создайте приложение.
4. На странице приложения появятся значения api_id и api_hash — скопируйте их в .env как API_ID и API_HASH.

Запуск
1. Активируйте виртуальное окружение:
   source venv/bin/activate
2. Запустите клиент:
   python client.py
3. При первом запуске Telethon запросит номер телефона и код подтверждения — введите. Сессия сохранится в файле с именем SESSION_NAME (по умолчанию session.session).

Команды (интерфейс командной строки)
- help — показать справку
- me — информация о текущем пользователе
- dialogs — показать список диалогов (чаты, каналы, пользователи)
- select <num> — выбрать чат по номеру из списка dialogs
- history [n] — показать последние n сообщений (по умолчанию 20)
- send <text> — отправить текст в выбранный чат
- sendfile <путь> — отправить файл/картинку/аудио в выбранный чат
- download <msg_id> <путь> — скачать медиа из сообщения (msg_id из вывода history)
- lang — переключить язык интерфейса (ru/en)
- exit / quit — выйти из клиента

Примеры
- Просмотреть диалоги:
  dialogs
- Выбрать второй чат:
  select 2
- Посмотреть историю 50 сообщений:
  history 50
- Отправить сообщение:
  send Привет!
- Отправить файл:
  sendfile /Users/you/Pictures/photo.jpg
- Скачать медиа из сообщения:
  download 123 /Users/you/Downloads/

Советы по безопасности и эксплуатации
- Не храните API_HASH в публичных репозиториях. Добавьте .env в .gitignore.
- Если нужно поделиться кодом, удалите или замените реальные значения API_ID/API_HASH.
- Сессия хранится локально в файле SESSION_NAME.session — защитите доступ к этому файлу.
- Для автоматизации/демонов можно запускать клиент внутри screen/tmux и при необходимости доработать обработку сигналов и логирование.

Ограничения первого варианта
- Простой консольный интерфейс без TUI (curses/textual).
- Нет автодополнения команд и прогресс‑баров.
- Не реализованы редактирование/удаление сообщений, реакции, звонки и расширенные медиа‑опции (конвертация, предпросмотр).
- Поиск по сообщениям/диалогам не реализован.

Что можно дополнительно добавить
- Прогресс‑бар при загрузке/скачивании больших файлов (tqdm).
- Автодополнение команд и история ввода (prompt_toolkit).
- Полноэкранный TUI с навигацией (textual, urwid, curses).
- Поиск по сообщениям и диалогам.
- Пагинация истории и поиск по дате/автору.
- Поддержка удаления/редактирования сообщений, реакции, прикреплённые места.
- Логирование и режим демона (systemd, launchd).
- Поддержка нескольких сессий/профилей.

Дополнительные библиотеки для расширений
- prompt_toolkit — автодополнение, история ввода
- tqdm — прогресс‑бар
- textual / urwid / curses — для полноценного TUI
- Pyrogram — альтернативная MTProto‑библиотека (иногда удобнее)

Поддержка и отладка
- Если Telethon при авторизации просит код и не приходит — проверьте, что используете корректный номер и приложение Telegram установлено и доступно.
- При ошибках MTProto (Flood, AuthKey) подождите или создайте новое API‑приложение.
- Включите подробные логи Telethon, добавив в начало client.py:
  import logging; logging.basicConfig(level=logging.INFO)

Лицензия
- Код предоставляется без явной лицензии — используйте по своему усмотрению.